ccm.component({name:'vokabeltrainer',config:{html:[ccm.store,{local:'vokabeln_html.json'}],key:'vokabeltrainer',store:[ccm.store,'./vokabeln.json'],style:[ccm.load,'./vokabeltrainer.css'],user:[ccm.instance,'https://kaul.inf.h-brs.de/ccm/components/user2.js']},Instance:function(){var self=this;self.init=function(callback){self.store.onChange=function(){self.render();};callback();};self.render=function(callback){var element=ccm.helper.element(self);self.store.get(self.key,function(dataset){if(dataset===null){self.store.set({key:self.key,vokabeln:[]},proceed);}else{var i=0;var richtigeantworten=0;proceed(dataset,i,richtigeantworten);}function proceed(dataset,i,richtigeantworten){var antworten=richtigeantworten;var j=i;if(dataset.vokabeln.length===j){element.html(ccm.helper.html(self.html.get('main')));var user_div=ccm.helper.find(self,'.user');ccm.helper.find(self,'.user').html(ccm.helper.html({inner:ccm.helper.val("Benutzer: "+dataset.user)}));user_div.append(ccm.helper.html(self.html.get('auswertung')));ccm.helper.find(self,'.auswertung').html(ccm.helper.html({inner:ccm.helper.val("Anzahl der richtigen Vokabeln:"+ antworten)}));alert("Ende");return;}else{element.html(ccm.helper.html(self.html.get('main')));var user_div=ccm.helper.find(self,'.user');ccm.helper.find(self,'.user').html(ccm.helper.html({inner:ccm.helper.val("Benutzer: "+dataset.user)}));user_div.append(ccm.helper.html(self.html.get('description')));ccm.helper.find(self,'.description').html(ccm.helper.html({inner:ccm.helper.val("Beschreibung: "+dataset.description)}));var vokabel=dataset.vokabeln[j];user_div.append(ccm.helper.html(self.html.get('abfrage'),{}) );ccm.helper.find(self,'.vokabel').html(ccm.helper.html({inner:ccm.helper.val("Vokabel: "+vokabel.vokabel)}));user_div.append(ccm.helper.html(self.html.get('feedback')));user_div.append(ccm.helper.html(self.html.get('input'),{onsubmit:function(){var value=ccm.helper.val(ccm.helper.find(self,'input').val()).trim();if(value==='')return;if(value===vokabel.antwort){antworten++;ccm.helper.find(self,'.feedback').html( ccm.helper.html({inner:ccm.helper.val("Richtig")}));}else{ccm.helper.find(self,'.feedback').html(ccm.helper.html({inner:ccm.helper.val("Falsch, Richtige Anwort w√§re gewesen:"+vokabel.antwort)}));}return false;}}));user_div.append(ccm.helper.html(self.html.get('next'),{onclick:function(){j++;proceed(dataset,j);return false;}}));}if(callback)callback();}});};}});
